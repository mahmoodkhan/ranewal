{% extends 'base.html' %}
{% load staticfiles %}
{% load crispy_forms_tags %}

{% block content %}
    <div id = "pr_form_div" class="row">
        <div class="col-md-12">
            <div class="panel panel-info">
                <div class="panel-heading"><h4> New Purchase Request Form for Goods </h4></div>
                <div class="panel-body">
                    {% crispy form %}
                </div>
            </div>
        </div>
    </div>

    <div id="pr_itemforset_div" class="row" >
        <div class="col-md-12">
            <div class="panel panel-default">
                <div class="panel-heading">Purchase Request Detail<div class='pull-right'><button id='back_to_pr_form' class='btn btn-xs btn-info'> <span class='glyphicon glyphicon-menu-left'></span> Back</button></div></div>
                <div class="clearfix"></div>
                <div class="panel-body">
                
                </div>
            </div>
        </div>
    </div>
{% endblock content %}

{% block extra_js %}
<script type = "text/javascript">
    // submit the form via ajax and then show to add items to it.
    $("#pr_form_div").on('submit', '#id_prform', function(event) {
        // Stop the form from submitting to the server
        event.preventDefault();

        // Submit the form via ajax and update 'adding items' section with the server response.
        $(this).find('label').each(function(){
            console.log($(this).text() + " : " +  $(this).parent().find('input,textarea,select').filter(':visible:first').val()); 
        });

        // hide the form and show its summary
        $('#pr_form_div').hide();
        $('#pr_itemforset_div').show();
    });

    // Make it go back to the PR form
    $("#pr_itemforset_div").on("click", "#back_to_pr_form", function(event) {
        $("#button-id-next").show();
        $('#pr_form_div').show();
        $('#pr_itemforset_div').hide();
    });

    // Make it go back to adding items without updating the form
    $("#pr_form_div").on("click", "#button-id-next", function() {
        $('#pr_form_div').hide();
        $('#pr_itemforset_div').show();
    });

    // When document is fully loaded, do the following
    $(document).ready(function() { 
        $("#button-id-next").hide();
        $("#id_currency").select2({ allowClear: true, });
        $("#id_approver1").select2({ allowClear: true, });
        $("#id_approver2").select2({ allowClear: true, });
    });
</script>
{% endblock %}